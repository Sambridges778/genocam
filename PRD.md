# GenoCam 产品需求文档（PRD）

版本：v0.1
更新时间：2025-11-01
适用范围：Geno 复古相机滤镜（HarmonyOS / ArkUI）
参考文档：
- 《README.md》：项目概述、技术路线与里程碑
- 《UI设计规范.md》：视觉与交互规范（字体、色彩、布局、动效、组件）

## 1. 产品概述
- 产品定位：一键直出高质量复古照片/视频的移动相机应用，强调“真实胶片色调、轻量交互、慢而有克制的动效”。
- 愿景（来自 README）：你的口袋里的专业摄影师；无需后期编辑，一键直出复古摄影/视频；还原 80 年代胶片质感。
- 目标平台：HarmonyOS（Stage 模式，ArkUI 声明式 UI）。
- 入口能力：`EntryAbility`，主页 `pages/Index` 挂载 `CameraPage`。

## 2. 目标与成功标准
- 核心目标：
  - 提供真实且高效的复古拍摄体验（胶片/视频风格覆盖、低延迟预览、快速拍摄/保存）。
  - 附加功能齐备且不打扰拍摄主流程（网格/定时/闪光/附件等）。
  - 在低端设备上保持交互流畅与可用性（自适应分辨率/帧率/滤镜强度）。
- 成功标准（KPI）：
  - 预览启动延迟（进入相机页至预览可见）≤ 120ms（目标）/ ≤ 250ms（上限）。
  - 拍照总时延（快门 → 保存完成）≤ 1.2s（目标）/ ≤ 2.0s（上限）。
  - 视频开始时延（点击录制 → 第一帧编码写入）≤ 1.5s（目标）。
  - 预览帧率稳定：照片 ≥ 30fps；视频模式可选 30/60fps，根据设备自适应。
  - Crash-Free 会话 ≥ 99.9%；权限拒绝/撤销下交互可恢复且提示清晰。

## 3. 用户画像与使用场景
- 画像：
  - 复古摄影爱好者：追求胶片质感；需要底片保存与重冲洗。
  - Vlogger/创作者：偏好复古视频模式（8mm/16mm/VHS 等），需要稳定与附件。
  - 普通用户：希望简单直出的复古风格自拍或风景，轻量操作。
- 场景：街拍、旅行、人像、日常生活、静物记录、短视频拍摄。

## 4. 范围（Scope）
- 胶片与相机类型（来自 README）：
  - 胶片规格：`135`、`120`、半格、一次性、3D、正片幻灯片。
  - 相机类型：玩具相机、即时成像等复古机型；现代数码风格（微单、CCD）。
- 复古视频模式：8mm/16mm/VHS/DCR/电影机、幻灯片放映机等。
- 拍摄附加功能：
  - 底片保存与重冲洗；双重曝光；定时拍摄；闪光/滤色片；导入处理。
  - 色温/色调、曝光补偿、ISO/快门、稳定、构图网格；特殊镜头（鱼眼/星光/色散/ND）。

## 5. 信息架构（IA）与导航
- 页面（与《UI设计规范.md》一致）：
  - `CameraPage`：预览、预设走马灯、底部工具栏、侧边参数与附件托盘。
  - `PresetPicker`：胶片/数码/视频分类网格，预览与收藏。
  - `LabPage`：底片库、重冲洗（曝光/色温/曲线/颗粒/晕影/滤色片）、版本管理。
  - `GalleryPage`：网格浏览、详情与导出/分享。
  - `SettingsPage`：拍摄/视频/反馈/系统（权限/存储）。
  - `Onboarding`：首启引导与权限申请、手势教学。
- 导航：
  - 主导航为底部栏（相机、预设、底片/重冲洗、相册）；设置入口位于右上角。
  - 二级导航为底部工具条与抽屉；手势支持返回与关闭。

## 6. 功能需求（按里程碑划分）
- M1（相机基础）：
  - 相机预览（照片/视频）；拍照与保存；基础胶片预设（LUT+曲线）。
  - 构图网格（3x3/黄金比例）；相册入口与缩略图；前后摄切换。
  - 资源管理：预设列表与基本参数映射。
- M2（拍摄增强）：
  - 底片保存/重冲洗；曝光补偿（EV 滑条），色温/色调；附件托盘。
  - 导入照片处理；定时器；闪光灯与滤色片；基础稳定（视频）。
- M3（视频进阶）：
  - 录像；复古视频模式（8mm/16mm/VHS/DCR/电影机）；视频分辨率/帧率切换。
  - 防抖档位；实时滤镜链与编码。
- M4（创作扩展）：
  - 双重曝光；镜头附件（鱼眼/星光/色散/ND）；更多预设；收藏与搜索。
- M5（质量与国际化）：
  - 性能调优、资源优化；国际化与可访问性；完整测试矩阵与发布流程。

## 7. 关键业务流程
- 照片拍摄：打开 `CameraPage` → 预览就绪 → 选择预设 → 点击快门 → 滤镜链处理 → 保存至相册 → 弹出轻反馈。
- 视频录制：选择视频模式 → 预览就绪 → 点击录制 → 实时滤镜链 → 停止录制 → 编码保存 → 成功提示。
- 导入处理：在 `LabPage` 选择“导入” → 从系统相册选取 → 应用预设 → 保存新副本/版本。
- 底片重冲洗：打开底片详情 → 调整（曝光/色温/曲线/颗粒等） → 生成版本 → 保存与对比。

## 8. 非功能需求
- 性能优化（引用 README“性能优化策略”）：
  - 预加载与池化：相机会话、LUT/纹理、渲染管线、编码器复用。
  - 并发：CPU 密集使用 ArkTS `worker`；GPU 使用统一图像处理节点图。
  - 自适应：分辨率/帧率/滤镜强度随设备性能调整；资源缓存降低 I/O。
- 稳定性：崩溃率控制、权限拒绝容错、异常提示清晰；日志与统计。
- 可访问性与国际化：遵循《UI设计规范.md》的尺寸与对比度、触觉/声音反馈；简体中文为主，后续扩展。
- 兼容性：当前设备类型为 `phone`；后续扩展需适配横竖屏与比例（3:2/4:3/16:9）。

## 9. UI 设计与规范引用
- 全面遵循《UI设计规范.md》：
  - 字体配比：标题 `28fp`、副标题 `18fp`、正文 `14fp`、正文行高 `20fp`（资源键已存在）。
  - 颜色系统：`bg_surface`、`bg_surface_alt`、`text_primary`、`text_secondary`、`accent_primary`、`grid_line`。
  - 布局与尺寸：4/8 网格；圆角 12/16vp；快门直径 72vp；预设走马灯 88vp 容器。
  - 动效：慢、柔、克制；状态清晰，保证可访问性与对比度。
- 入口页面：`Index.ets -> CameraPage()`（已挂载），后续按规范补齐 `PresetPicker/Lab/Gallery/Settings`。
- 验收点（UI）：
  - 对比度满足可读性；触控目标最小 48vp；页面结构与 IA 一致。
  - 资源引用通过 ArkUI `$r('app.color.*')/$r('app.float.*')` 统一管理。

## 10. 权限与合规
- 清单建议（参考 README）：
  - `ohos.permission.CAMERA`、`ohos.permission.MICROPHONE`（视频录制）。
  - `ohos.permission.READ_MEDIA`、`ohos.permission.WRITE_MEDIA`（媒体读写）。
  - `ohos.permission.FLASHLIGHT`（闪光灯）。
- 运行时权限：首启 `Onboarding` 或进入相机页时请求；拒绝时给出引导与降级方案。

## 11. 技术方案概述
- 架构分层（参考 README）：
  - UI 层：ArkUI（`CameraPage`、`PresetPicker`、`LabPage`、`GalleryPage`、`SettingsPage`）。
  - 能力层：`UIAbility`、备份扩展；窗口与权限管理。
  - 媒体管线层：相机采集（预览/拍照/录像）、滤镜链（LUT/曲线/颗粒/晕影/色散等）、编码与保存。
  - 资源与预设：JSON/LUT/纹理；镜头附件；视频模式配置。
  - 存储层：底片与重冲洗版本信息、用户偏好/数据库/媒体库。
- API 流程（示意）：`CameraManager → CaptureSession → Preview/Photo/Video Output → Surface/PixelMap → 滤镜链 → 媒体库保存`。

## 12. 指标与验收标准
- 技术指标：
  - 预览启动 ≤ 120ms；拍照保存 ≤ 1.2s；录像启动 ≤ 1.5s。
  - 预览帧率 ≥ 30fps；视频支持 30/60fps；丢帧率 ≤ 1%。
  - 内存占用：照片场景 ≤ 256MB；视频场景 ≤ 350MB（含滤镜链）。
  - CPU/GPU 利用率：在目标设备保持 UI 流畅与温度可控（无明显卡顿与过热）。
  - Crash-Free ≥ 99.9%；权限交互覆盖率 100%。
- 功能验收：
  - M1-M5 每项功能均有可操作的 UI 与正确的处理结果（照片/视频/重冲洗/导入）。
  - 资源与预设可加载；列表与详情一致性；收藏与搜索工作正常。
- UI 验收：
  - 字体、颜色、尺寸与动效严格匹配《UI设计规范.md》；暗/亮主题一致性。

## 13. 测试计划（参考 README“测试与质量保障”）
- 单元：滤镜链纯函数、预设解析、参数映射。
- 集成：相机预览/拍照/录像；权限流转；异常处理；影像质量基准对比。
- 模拟与桩：使用 `hamock` 对相机/媒体库进行接口桩替换以保障流水线测试。
- UI/交互：关键交互（快门、走马灯、EV 滑条、附件托盘）在不同主题/比例下的可用性与可访问性。

## 14. 迭代与里程碑
- M1：预览、拍照、基础预设。
- M2：底片/重冲洗、曝光与色温、构图网格、导入、附件。
- M3：录像与复古视频模式、防抖与编码。
- M4：双重曝光、镜头附件扩展、更多预设与收藏。
- M5：性能调优、资源优化、国际化与可访问性、完整测试矩阵与发布。

## 15. 风险与对策
- 设备兼容与性能差异：采用自适应策略与降级方案；提供设置开关。
- 相机权限与隐私合规：统一权限入口与清晰提示；拒绝时降级到导入模式。
- GPU/LUT 支持差异：保底 CPU 路径与质量控制；资源按需加载与分包。
- 资源体积膨胀：建立资源优化与分包策略；缓存与复用。
- 影像质量一致性：建立胶片色彩基准与对比流程；定期校准预设。

## 16. 开放问题
- 预设商业与社区共享策略？
- 更多设备类型的适配优先级？
- 是否引入云备份与跨设备同步？

## 17. 交付物
- ArkUI 页面：`CameraPage` 已挂载；后续 `PresetPicker/Lab/Gallery/Settings` 按里程碑交付。
- 设计资源：颜色与字体资源键已建立；图标/纹理/LUT 资源按需补充。
- 文档：本 PRD 与《UI设计规范.md》，以及 README 的技术路线说明。