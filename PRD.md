# PRD v1 — Geno（鸿蒙）食物浪费减少平台（参考 Too Good To Go）

说明
- 本PRD基于你的方向：项目更名为“Geno”，全面学习 Too Good To Go 的核心体验。
- 目标平台：HarmonyOS（ArkTS/ArkUI）。
- 本版仅定义方向与首版范围，不引入未提供的具体参数或第三方细节；涉及支付、地图等能力以“待选”占位。

1. 产品概述
- 愿景：连接本地商家与消费者，以“临期/当日剩余食物礼包”的形式减少浪费，让优质食物以亲民价格被及时领取。
- 价值：环保与社会价值；消费者以更低价格获得惊喜礼包；商家降低损耗并获得增量客流。
- 灵感：学习 Too Good To Go 的“魔法礼包（Surprise Bag）+ 预约取餐时间段”的模式与流程。

2. 用户与角色
- 消费者（User）：浏览附近商家、预约礼包、付款、到店取餐、评价与收藏。
- 商家（Merchant）：发布可售礼包、设置取餐时间段与数量、管理订单与核销、查看基础数据。
- 管理后台（Admin，后续阶段）：审核商家资质、风控与客服支持。

3. 首版范围（MVP）
- 消费者侧：
  - 浏览：附近商家列表/地图切换、筛选（距离/价格/品类/时间段）。
  - 详情：商家信息、礼包说明、可预约时间段与剩余数量。
  - 下单：选择时间段→确认订单→付款（支付能力待选）→生成取餐凭证（二维码/码）。
  - 订单：待取餐/已完成/已取消的订单列表与详情；取餐完成后可评价。
  - 收藏与提醒：收藏商家、到点提醒与取餐提醒（系统通知）。
- 商家侧（轻量）：
  - 发布：创建礼包（名称、价格、取餐窗口、数量、说明）。
  - 管理：查看待取餐订单与已完成订单；到店核销（二维码/码扫描）。
  - 设置：营业时间、门店基本信息、库存开关。

4. 信息架构（消费者）
- 欢迎/引导（Onboarding）→ 位置权限 → 首页（地图/列表切换）
- 商家详情 → 选择时间段 → 下单/付款 → 订单成功 → 到店取餐（出示凭证）
- 订单列表与详情 → 评价 → 收藏/取消收藏 → 设置（通知、隐私）

5. 关键流程
- 5.1 浏览与发现
  - 打开首页，默认“附近”排序；可在顶部切换地图/列表；支持筛选。
- 5.2 预约与支付
  - 商家详情页选择“取餐时间段”和数量→确认订单→付款→生成凭证。
- 5.3 到店取餐与核销
  - 到店后出示凭证二维码；商家端扫码或输入码完成核销；订单状态更新为“已完成”。
- 5.4 取消与退款（占位）
  - 在取餐开始前可取消；退款与规则按平台策略（待定）执行。

6. 页面与UI（ArkUI）
- 组件尺寸与可触达：遵循《UI设计规范.md》（48vp最小触达、4/8栅格、圆角12/16vp）。
- 页面清单（消费者）：
  - WelcomePage：品牌与价值说明，进入授权与首页；
  - HomePage（列表/地图）：搜索、筛选、商家卡片；
  - ShopDetailPage：门店信息、礼包描述、时间段选择、剩余数量；
  - CheckoutPage：订单确认与付款占位；
  - OrderSuccessPage：生成凭证（二维码或数字码）；
  - OrdersPage：订单列表（待取餐/已完成/已取消）；
  - OrderDetailPage：订单详情、凭证、路线与提醒；
  - FavoritesPage：收藏的商家；
  - ProfilePage：个人信息、设置、通知开关、隐私与协议；
- 页面清单（商家轻量）：
  - MerchantHomePage：今日礼包与订单概览；
  - CreateBagPage：创建/编辑礼包；
  - MerchantOrdersPage：待取餐订单、已完成订单；
  - RedeemPage：扫码核销（摄像头/二维码解析）；

7. 功能需求（MVP）
- 地理能力：定位当前城市与周边距离，地图展示（地图能力待选）。
- 通知与提醒：下单成功、临近取餐窗口提醒、系统公告。
- 账号：手机号/邮箱注册登录（方式待选）；支持游客浏览。
- 订单与凭证：生成唯一凭证；消费者端展示，商家端扫码验证。
- 收藏与评价：收藏商家；订单完成后可评价（文本与星级）。
- 基础风控：同一订单仅可核销一次；凭证过期不可用。

8. 非功能需求
- 性能：
  - 首次有效绘制与可交互时间优化（按规范使用 const、小组件拆分）。
  - 列表与地图滚动流畅；分页与懒加载。
- 可用性与无障碍：
  - 文本对比度与最小触达面积；支持屏幕阅读与字体放大；
  - 错误采用屏内 SelectableText.rich 红色提示，避免SnackBar遮挡。
- 稳定与安全：
  - 传输加密，凭证随机性与单次校验；
  - 隐私合规（定位、通知等权限说明与撤回入口）。

9. HarmonyOS 能力与权限（占位）
- ArkUI 页面架构（ETS/ArkTS）。
- 能力：
  - 定位（位置权限）；
  - 摄像头（核销扫码）；
  - 通知（系统通知提醒）；
  - 存储与网络访问；
- 权限文案与触发时机：首次进入相关功能前弹出授权说明；可在设置中撤回。

10. 数据模型（示例占位）
- 统一字段：created_at、updated_at、is_deleted（只读写策略按约定）。
- 实体：
  - user：基本信息、收藏集合引用；
  - merchant：门店信息、营业时间；
  - bag：名称、描述、价格、库存、取餐时间段、门店引用；
  - order：用户引用、门店/礼包引用、状态、凭证、时间段；
  - voucher：订单引用、二维码/码、过期时间、核销状态；
  - favorite：user↔merchant 关系；

11. 指标（不设具体数值）
- 体验：下单-凭证生成的成功率与耗时；
- 质量：崩溃率与网络失败率；
- 生态：商家活跃、消费者留存与评价分布。

12. 里程碑（MVP到迭代）
- M1 消费者浏览与下单：首页、详情、下单、订单、凭证展示、通知提醒。
- M2 商家轻量：创建礼包、订单管理与核销。
- M3 支付与地图能力落地：完成支付集成与地图展示（供应商待选）。
- M4 评价、收藏与基础分析：评价闭环与收藏页；商家数据概览。

13. 风险与待决
- 支付供应商选择与接入（待选）。
- 地图能力供应与许可（待选）。
- 食品安全与责任边界文案（法律合规审核）。
- 退款与取消政策设计（待选）。

14. 交付物
- 原型：ArkUI 页面骨架与交互流；
- 文档：权限与隐私说明、数据模型定义、页面流程说明；
- 代码：首页/详情/下单/订单/凭证、商家轻量页面的 ArkTS 组件骨架；
- 测试：关键流程用例与端到端场景（浏览→下单→核销）。

附：UI与设计约束（引用《UI设计规范.md》）
- 栅格与间距：4/8系统；模块化布局；
- 角与层次：卡片圆角 12/16vp；浮层阴影软化；
- 字体与对比度：标题/正文比例与对比度；
- 交互尺寸：最小触达 48vp；
- 错误呈现：屏内可选择文本红色提示；